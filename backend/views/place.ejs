<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Places</title>
  <link rel="stylesheet" href="/place.css">
</head>
<body>

        <!-- navbar -->
    <%- include('navbar/nav.ejs') %>
   


  <header>
    <h1>All Places</h1>
  </header>

  
    <div class="center">

  <div class="card-container">
  <% places.forEach(place => { %>
    <a href="/place/<%= place._id %>" class="card-link">


      <div class="card">
  <img src="<%= place.images[0] %>" alt="<%= place.name %>" class="place-img">
  
  <div class="card-content">
    <h2><%= place.name %></h2>
    <p class="rat"><strong>â˜… :</strong> <%= place.averageRating %></p>
    <p><strong>Cuisines:</strong> <%= place.cuisines.join(", ") %></p>
    <p> price : <%= place.price  %> One Person</p>
  </div>
</div>

      
    </a>
  <% }) %>
</div>

        
    </div>


<script>
  const searchInput = document.getElementById('searchInput'); // navbar search
const placesContainer = document.querySelector('.card-container');
const links = Array.from(document.querySelectorAll('.card-link')); // <a> elements

// store original order
const originalOrder = links.slice();

searchInput.addEventListener('input', () => {
    const query = searchInput.value.toLowerCase().trim();

    const matches = [];
    const nonMatches = [];

    links.forEach(link => {
        const card = link.querySelector('.card');
        const titleElement = card.querySelector('h2');
        const descElements = Array.from(card.querySelectorAll('p'));

        const titleText = titleElement.textContent;
        const descText = descElements.map(p => p.textContent).join(' ');

        // reset previous highlights
        titleElement.innerHTML = titleText;
        descElements.forEach(p => p.innerHTML = p.textContent);

        if (query && (titleText.toLowerCase().includes(query) || descText.toLowerCase().includes(query))) {
            matches.push(link);

            // highlight matching text
            const regex = new RegExp(`(${query})`, "gi");
            titleElement.innerHTML = titleText.replace(regex, `<span style="background: yellow; color: black; pointer-events: none;">$1</span>`);
            descElements.forEach(p => {
                p.innerHTML = p.textContent.replace(regex, `<span style="background: lightblue; color: black; pointer-events: none;">$1</span>`);
            });

        } else {
            nonMatches.push(link);
        }
    });

    // reorder <a> links safely
    matches.forEach(link => placesContainer.prepend(link));
    nonMatches.forEach(link => placesContainer.appendChild(link));
});

</script>

  <%- include('chatbot') %>
    <br> <br> <br> <br> <br> <br> <br> <br> <br>

<%- include('navbar/footer.ejs') %>
       <script src="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
